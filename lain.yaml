appname: archon

build:
  base: registry.lain.ein.plus/einplus/centos-base:20171122
  version: "20180618"
  prepare:
    script:
      - yum install make gcc
      - yarn install
      - yarn build
    keep:
      - node_modules
  script:
    # - yarn install --verbose
    - yarn build
    - mkdir -p /go/src/github.com/laincloud/archon
    - cp -rf main.go /go/src/github.com/laincloud/archon/
    - GOPATH=/go go install github.com/laincloud/archon
    - cp /go/bin/archon /lain/app/archon

web:
  cmd: /lain/app/archon -port=8080 -staticdir=/lain/app/dist
  port: 8080
  memory: 256M

notify:
  slack: "#lain"
